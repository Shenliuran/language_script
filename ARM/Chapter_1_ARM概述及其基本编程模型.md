# 第一章 ARM概述及其基本编程模型

## ARM处理模式

+ 非特权模式：
    1. usr（用户模式）：正常程序执行的模式
+ 特权模式：
    1. sys（系统模式）：用于运行特权级的操作系统任务
    2. sve（特权模式）：供操作系统使用的一种保护模式
    3. und（未定义指令中止模式）：用于支持通过软件仿真硬件的协处理器
    4. abt（数据访问中止模式）：用于虚拟储存及存储保护
    5. irq（外部中断模式）：用于通常的中断处理
    6. fiq（快速中断模式）：用于高速数据传输与通信

## ARM寄存器

+ 总共有37个寄存器：31个通用寄存器 + 6个状态寄存器
+ 31个通用寄存器可以分为3类：
    1. 未备份寄存器：R0 ~ R7
    2. 备份寄存器：R8 ~ R14
    3. 程序计数器：R15（PC）
+ 寄存器R13通常称为堆栈指针（SP）：保存栈的地址，使其指向该模式专用的栈地址（也可以写成sp）
+ 寄存器R14通常称为程序连接器寄存器（LR）：存放当前子程序的返回地址，也可以作为通用寄存器
+ 寄存器R15称为程序计数器
+ 程序状态寄存器（CPSR）
    1. 格式（SPSR与此相同）![avatar](../images/CPSR格式图.png)
    2. CPSR中的条件标志位
    >标志位|含义
    >|:--:|:--:|
    >N|本位设置当前命令运算结果的`bit[31]`的值</br>当 **两个补码** 表示的 **有符号整数运算**:</br>N = 1 表示运算的结果为负数</br>N = 0 表示运算结果为整数或零
    >Z|Z = 1 表示运算结果为0</br>Z = 0 表示运算结果不为0
    >C|下面分4种情况讨论C的设置方法：</br>在 **加法指令中（包含比较指令CMN）** ，当结果产生了进位，则 C = 1，表示无符号数运算发生上溢；请他情况下C = 0</br>在 **减法指令中（包含比较指令CMP）** ，当运算发生了借位，则 C = 0，表示无符号运算发生了下溢；请他情况下 C = 1;</br>对于包含移位操作的非加法/减法运算指令，C包含最后一次溢出的位的数值</br>对于其他非加法/减法运算指令，C位的值通常不受影响
    >V|对于加/减法运算指令，当操作数和运算结果为二进制的补码表示的带符号数，V = 1 表示符号位溢出</br>通常其他的指令不影响V位，具体可参考各指令说明
    >当这些符号位对应的数值为0是，字母位小写；数值为1时，字母为大写
